<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>アクションモードテスト</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .test-section {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #333;
            margin-bottom: 15px;
        }
        .test-item {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-left: 3px solid #4CAF50;
        }
        .test-item.fail {
            border-left-color: #f44336;
        }
        .test-item.pending {
            border-left-color: #FF9800;
        }
        .status {
            font-weight: bold;
            margin-right: 10px;
        }
        .pass { color: #4CAF50; }
        .fail { color: #f44336; }
        .pending { color: #FF9800; }
    </style>
</head>
<body>
    <h1>将棋カードゲーム - アクションモードテスト</h1>
    
    <div class="test-section">
        <h2>実装チェックリスト</h2>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            Game.jsに<code>currentTurnAction</code>と<code>hasPerformedAction</code>の状態を追加
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            <code>selectActionMode()</code>メソッドでアクションモードの切り替えを実装
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            <code>updateActionModeUI()</code>メソッドでUIの更新を実装
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            Board.jsの<code>selectPiece()</code>で駒移動モードのチェックを追加
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            Board.jsの<code>tryMovePiece()</code>でアクション実行済みフラグを設定
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            Cards.jsの<code>handleCardClick()</code>でカード使用モードのチェックを追加
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            Cards.jsの<code>useCard()</code>でアクション実行済みフラグを設定
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            HTMLにアクション選択ボタンとステータス表示を追加
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            CSSでアクション選択UIのスタイルを定義
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            ターン終了時にアクション状態をリセット
        </div>
        
        <div class="test-item">
            <span class="status pass">✓</span>
            AIターンでもアクションモードを適切に選択
        </div>
    </div>
    
    <div class="test-section">
        <h2>動作フロー</h2>
        
        <div class="test-item">
            <strong>1. ターン開始時:</strong><br>
            - 両方のアクションボタンが有効<br>
            - ステータス: "アクションを選択してください"<br>
            - 駒もカードも選択できない状態
        </div>
        
        <div class="test-item">
            <strong>2. 駒移動モード選択時:</strong><br>
            - 駒移動ボタンがアクティブ（緑色）<br>
            - 駒をクリックして選択可能<br>
            - カードはクリックできない（警告表示）
        </div>
        
        <div class="test-item">
            <strong>3. カード使用モード選択時:</strong><br>
            - カード使用ボタンがアクティブ（緑色）<br>
            - カードをクリックして選択可能<br>
            - 駒はクリックできない（警告表示）
        </div>
        
        <div class="test-item">
            <strong>4. アクション実行後:</strong><br>
            - 両方のボタンが無効化<br>
            - ステータス: "アクション実行済み"<br>
            - モード切り替え不可
        </div>
        
        <div class="test-item">
            <strong>5. ターン終了時:</strong><br>
            - すべての状態がリセット<br>
            - 次のプレイヤーのターンへ
        </div>
    </div>
    
    <div class="test-section">
        <h2>主な変更点</h2>
        
        <div class="test-item">
            <strong>選択の明確化:</strong> プレイヤーはターンの最初に「駒を動かす」か「カードを使う」かを明示的に選択する必要があります。
        </div>
        
        <div class="test-item">
            <strong>制限の実装:</strong> 一度選択したら、そのターン中は他のアクションを実行できません。
        </div>
        
        <div class="test-item">
            <strong>UI フィードバック:</strong> 現在のモードと状態が常に表示され、無効な操作には警告メッセージが表示されます。
        </div>
        
        <div class="test-item">
            <strong>AI対応:</strong> AIも同じルールに従い、アクションモードを選択してから行動します。
        </div>
    </div>
    
    <div class="test-section">
        <h2>テスト手順</h2>
        
        <div class="test-item">
            1. ゲームを開始し、駒移動ボタンをクリック
        </div>
        
        <div class="test-item">
            2. 駒を選択して移動を実行
        </div>
        
        <div class="test-item">
            3. アクション実行後、ボタンが無効化されることを確認
        </div>
        
        <div class="test-item">
            4. 次のターンで、カード使用ボタンをクリック
        </div>
        
        <div class="test-item">
            5. カードを選択して駒を召喚
        </div>
        
        <div class="test-item">
            6. モード未選択時に駒やカードをクリックし、警告が表示されることを確認
        </div>
    </div>
</body>
</html>